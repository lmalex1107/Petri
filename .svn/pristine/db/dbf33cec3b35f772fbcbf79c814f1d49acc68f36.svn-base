package model;

import java.util.ArrayList;

public class Erreichbarkeitsgraph {
	ArrayList<ERKnot> erknotlist;
	ERKnot firstERKnot;
	ERKnot actual_ERKnot;
	
	
	
	public Erreichbarkeitsgraph (int[] startmarking) {
		erknotlist = new ArrayList<ERKnot> ();
		firstERKnot = new ERKnot(startmarking);
		erknotlist.add(firstERKnot);
		testprint();
	}
	
	
	
	
	/**
	 * In der Methode 'insert_knot ('Knoten einfügen') wird eine Liste von Markierungen zur Bildung eines neuen Knotens übergeben.
	 * Die zweite Markierungsliste zeigt an, an welcher Stelle, also an welchen Vorgänger-Knoten, 
	 * der neue Knoten angefügt wird. Außerdem gibt eine ID an, welcher Transitor im zugehörigen Petri-
	 * Netz geschaltet wurde.
	 * @param ERKnot
	 * @param ERSuccessor
	 * @param TransitionID
	 */
	public void insert_knot(int[] Marking, int[] ERSuccessor, String TransitionID) {
		ERKnot erknot = new ERKnot(Marking);
		String former_label = ERKnot.MarkingToString(ERSuccessor);
		
		if (find(former_label) != null) {
			erknot.setSuccesor(find(former_label));
			find(former_label).setPredecessor(erknot);
			
		}
		erknotlist.add(erknot);
		testprint();
		
	}
	
	private ERKnot find (String label) {
		ERKnot erknot = null;
		boolean found = false;
		int i = 0;
		do {
			if (this.erknotlist.get(i).getLabel().equals(label)) {
				found = true;
				erknot = this.erknotlist.get(i);
			}
			else {
				i++;
			}
		}
		while ((found == false) && (i < this.erknotlist.size()));
		
		
		return erknot;
	}
	
	/**
	 * Die nachfolgende Methode überprüft, ob der Knoten bereits vorhanden ist
	 * und aktualisiert die vorhandenen Verbindungen zu ebendiesem Knoten.
	 */
	private void complete_connections() {
		
	}
	
	/**
	 * Das Herzstück der Klasse und des gesamten Programmes. Hierin wird überprüft, ob
	 * der Erreichbarkeitsgraph enlich ist oder nicht.
	 * @return
	 */
	public boolean isInfinity() {
		boolean finite = true;
		
		
		return finite;
	}
	
	public void testprint () {
		System.out.println("");
		System.out.println("aktueller Erreichbarkeitsgraph: ");
		for (int i = 0; i < this.erknotlist.size(); i++) {
			System.out.println(this.erknotlist.get(i).getLabel());
			if (this.erknotlist.get(i).getSuccessor().size() > 0) {
				System.out.println("VORGÄNGER ");
				for (int j = 0; j < this.erknotlist.get(i).getSuccessor().size(); j++) {
					System.out.println("   " + this.erknotlist.get(i).getSuccessor().get(j));
				}
			}
			
			
		}
		System.out.println("");
	}
	
}
